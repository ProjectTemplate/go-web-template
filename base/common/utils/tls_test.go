package utils

import (
	"github.com/stretchr/testify/assert"
	"testing"
)

var certData = `-----BEGIN CERTIFICATE-----
MIIFKjCCAxICCQCdkV+iL/cBTzANBgkqhkiG9w0BAQsFADBWMQswCQYDVQQGEwJD
TjEQMA4GA1UECAwHQmVpamluZzEQMA4GA1UEBwwHQmVpamluZzEQMA4GA1UECgwH
QWxpYmFiYTERMA8GA1UEAwwIQWxpS2Fma2EwIBcNMjIwNTExMTAzOTMxWhgPMjEy
MjA0MTcxMDM5MzFaMFYxCzAJBgNVBAYTAkNOMRAwDgYDVQQIDAdCZWlqaW5nMRAw
DgYDVQQHDAdCZWlqaW5nMRAwDgYDVQQKDAdBbGliYWJhMREwDwYDVQQDDAhBbGlL
YWZrYTCCAiIwDQYJKoZIhvcNAQEBBQADggIPADCCAgoCggIBAL315apERcpAkDAB
SY4A2bGrRZO4CXj4nvqbwEZ50f1HlwABjzUMKXES7lWrOwrnqZjSIgm5woqu+Pr4
sWhKFHN19SSnjeKilQoL8SzMk0p22QJK2sqKRMuHtoBtL6uOT+ykV16IEg0fY2Uu
/oX/sF2LAVCIl1IGc2HVKUr56c0/mM6V6Ur5Sum7ctKk2dm6YS5gwDOXcqAaZhwd
jVzqLEW8hmsMS7n+d2/NIJMqXvTHDRQ74xhR9tN2w92keEBGOQoMG/Qw0RvS1aQi
RKpNpvCE7z543istYuFbFji646u6kRCr7I2i4RwV0qXVM1djcS+PysUsIX4mEjdP
Kq0Fptzsii3aeTFuNswOlo5GieE3psVoymIP2HWd6xmlmFaX3Z8Nd4PxA6h0uRIY
tRbLkHw8WfOAl4dXxWQFkbvNYNLRB5xZUYjm3CA+ZhYfJRtNlPa2247Psnbup6CH
k3DP+aExdLmbtyugZO/lNqi9WMZ0qLFGXZDz8astgJPGKiCjihccpP1cdzGlCzGu
iE6S25JEBuXPl4wg4GXNuCg6tcEKL2qinvbrCimrilWuFajBh7hRH0dgkhezw6xU
+3++ZCebEJOXZ8byn3v/gmyx2PDnKlBPcXCy23nadbiX/zpNvNvCqAewajm9AlWY
fXbCl5TkUnyMPsh0rwWeeRYR2kM3AgMBAAEwDQYJKoZIhvcNAQELBQADggIBADxW
YJoWh9DVtwFGp8TOrlbZ7kwflKFv8Hew4SX00K5GwKgmnn3fjdR0F8rZ2ar/BqdD
zR63sv9LGjMci9NWAqPqN5MyKB97KrFV6nHzcYLRmT+ltolqcfp5MeGCqka7ZTEL
t658xxaSXNEY9HGHYskIu7mWd41KAj0RLRJnEEOrCSZzfpzG4LdD6J0u7wpyJSYL
jGxi2xswt5C0x790LS/JmFq65c/vzfATjbmu6XSO3UvtsADpj0pH3FJFhLzoT67o
NrUeFEHrzsMc7JenYmPIYmEb4xXlfctjCzLaiNG3u8uKwXGBk/oagAwXCsI8I0pR
wtW/QedXxlFtUfATRZnI/eLqvJ5cQ6aXg/GyJtAv+ccFf004K1ER00ECe738WNXm
+6NNkhN5gPhwsfoDhq+a7Zmvj9+x/XDjSRqZ8j+XIMi9ZQjTwUAg9JmnhyR4eJXn
oQAxGc3ii98YoAspKZGRX6LoRfYbNE3TXJsSzGw73+PqS1y74xNNmMx2XX6IV/53
Is5mA8fli6BIEKkAgE6Pn0t6v5EP6haVF84vJazYRIlYflR2mi8p8dU6kohiC79C
e4seRTTZgyXU+5dgFIXqagub2A79tRtPAr+4Xi84jzY84ceUwqX2fxRwkfaUUJb8
Hh2q+P+VJeK50B83DZ4ui+WNJbAaAbcLMsn/idX3
-----END CERTIFICATE-----`

var tencentCertData = `-----BEGIN CERTIFICATE-----
MIIDfTCCAmWgAwIBAgIUJqcUWJ/rUTMf+X/0G9HnU0ps30QwDQYJKoZIhvcNAQEL
BQAwTTELMAkGA1UEBhMCQ04xCzAJBgNVBAgMAkdEMQswCQYDVQQHDAJTWjEQMA4G
A1UECgwHdGVuY2VudDESMBAGA1UEAwwJbG9jYWxob3N0MCAXDTIxMTAyMDEyNDAz
N1oYDzIxMjEwOTI2MTI0MDM3WjBNMQswCQYDVQQGEwJDTjELMAkGA1UECAwCR0Qx
CzAJBgNVBAcMAlNaMRAwDgYDVQQKDAd0ZW5jZW50MRIwEAYDVQQDDAlsb2NhbGhv
c3QwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQDMWwsB2iXthQ/Anc5L
+zBQCr9P18FRNB/uHtsT6Z/TJDQr993YhR46Af1e92j5tsCe+9SYaQpexo1ZsBkx
bLkU0jn+s3YuueLr0aJ/K3Q558Z1AMP8fFkmnSiZ5q+VpuAGpkFHwpm6quseh+cJ
4ZWpsuiJuVQzKO+6M+2puHz6VVJRBC9Py8fj860mWDnXVZcNo4jRjgD6H2z60HQK
8qzT+aisczgHNx3ZMTEXZoDXqRzqya/94kc7u78KE2aC2P0LUehR0rO7wZqjC/Tz
+jduL4HE5H5gYXK+UBUwiJd5t7vs2zcTOKc/4KF71SzF4BUaTaeDOyEQBXl5HQYH
aPcLAgMBAAGjUzBRMB0GA1UdDgQWBBQKZtHW3Dzxw08fb4AQBa+uw61KCDAfBgNV
HSMEGDAWgBQKZtHW3Dzxw08fb4AQBa+uw61KCDAPBgNVHRMBAf8EBTADAQH/MA0G
CSqGSIb3DQEBCwUAA4IBAQAf14XPJDBxCsiC0jzyNW1ASRwlnbpqo6Y5NUnfrqGh
aMMV7MQHGC4Yu58de0qXCxSwOxK3zN7Dq0v0ARU9Yeg2JNpjQ6hsAEfonJdLQu3y
dlx8q9xqmNB2kkmeWLlg7X1oiUlksVw2O0yjproQKkUCW/TEH9aSkzEI4BS/3rbQ
63LOgJWeAZCFUnthcLUGhkpRONZAj87VPHq6rdCLcvnTFsSxWOvLHL12whiDyOtv
7ZM8na+BX9q5FgGETNE3Sv8j81bb5eQsPKu6uDVoBMDOl4XwP7Atl4esrBYwz5wu
cQ1zFkbcvC5OPkAah+2RTCk5RL70bLTiukj5SDJFrFqc
-----END CERTIFICATE-----`

func TestNewTlsConfig(t *testing.T) {
	config, err := NewTlsConfig(certData)

	assert.Nil(t, err)
	assert.NotNil(t, config)

	config, err = NewTlsConfig(tencentCertData)

	assert.Nil(t, err)
	assert.NotNil(t, config)
}
